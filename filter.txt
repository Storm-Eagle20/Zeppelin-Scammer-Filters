Any "//" followed by text is a comment. It is not part of the filter, but manually added to this page for transparency.
//This is a comment.

DO NOT ENTER ANY URLS LISTED IN THIS FILTER. YOU /WILL/ GET MALWARE FROM THEM. NOT ALL OF THEM ARE SIMPLE PHISHING ATTACKS.
------------------------------------------------------------------------------------------------------------
      rules:
        urlFilter:
          triggers:
          - match_regex:
              patterns:
                - '[dnopuy]\.(?!com|(co\.)?uk|net|org|gov|be|on|ca|us|de|jp|edu|es|it)[a-zA-Z]{2,5}\/'
                //Searches for a url ending in the letters d, n, o, p, u, or y. Brackets match any character inside them.
                //A backslash is an escape character. Periods are normally wildcard characters, which we don't want here.
                //"(?!example)". This is a NOT operator for a group. There are also a lot of OR operators in use here. So the filter breaks if it detects any of the top level domains here.
                //As a minor note, a question mark in front of a group of text, specifically "()?" means match "zero or one", or is simply an optional character.
                //The end of the filter has 2 to 5 lowercase or uppercase letters followed by an escaped forward slash.
                //
                //Any url such as scamdomain.xyz/ would be matched in this insance.
              case_sensitive: false
              match_messages: true
              match_visible_names: false
              match_usernames: false
              match_nicknames: false
              match_custom_status: false
          actions:
            clean: true
            log: true
            warn:
              reason: 'This is a test filter the Mega Man mod team set up, this is probably a false positive. Ignore it if so, we will look into it. Check the scammer thread located in the #server-discussion channel for more info.'
              notifyChannel: "521350130520031242"
        scammer:
          triggers:
          - match_regex:
              patterns: 
                - '([Cc][Ss]:? ?[Gg][Oo]|skins).{50,}(profiles|token)'
                  //"[Cc]" matches an uppercase *or* lowercase letter. In this instance, it's a filter for "CSGO" or "skins". 
                  //The formatting for CS:GO matches "CSGO", "CS:GO", "CS: GO", "CS GO", and lowercase equivalents.
                  //As mentioned earlier, periods are wildcard characters, used for its intended purpose in this case. It matches 50 or more wildcard characters.
                  //Wildcard characters are useful for "skipping ahead" and searching for terms that appear later.
                  //Some scam urls have "profiles" or "token" in them.
                  //
                  //Matches either CS:GO *or* skins, then sees if the term "profiles" or "token" appears later on. 
                  
                - 'don.t be (greedy|modest) and take few'
                  //Apostrophes break the code, so I had to use wildcards in place of them.
                  //Scammer sentence, incoherent english. Sometimes uses the word "greedy", sometimes "modest".
                  
                - '[Cc][Ss]:? ?[Gg][Oo].{3,}giving away'
                  //Matches CS:GO followed by "giving away" later on in the post. Scammers often mention they "quit CS:GO" and are "giving away skins".
                  
                - '([Hh]ello|[Hh]i).{20,}i will give a.{3,}knife'
                  //Matches "Hello" or "Hi" followed by "i will give a knife", again accounting for poor english. Another scammer phrase.
                  
                - '@everyone.+([Ss]team|STEAM|[Cc][Ss]:? ?[Gg][Oo]|bit\.ly|[Dd]iscord [Nn]itro (?![Mm]an))'
                  //Searches for an everyone ping, ".+" is an unlimited wildcard character, but it has to follow up with Steam, CS:GO, a shortlink, or Discord Nitro.
                  //Added a NOT operator so that people don't get banned for discussing Nitro Man. Yes. I really did this.
                  //Scammers FREQUENTLY tag everyone in their scam posts, while regular users basically never do it.
                  
                - '([Ss]team|STEAM|[Cc][Ss]:? ?[Gg][Oo]|bit\.ly|[Dd]iscord [Nn]itro (?![Mm]an)).+@everyone'
                  //Reverse of the above. A scammer thought they were clever by dodging a filter by moving the everyone ping to the end.
                  
                - 'first.{3,15}who send a trade'
                  //Scammers frequently say "the first [x] who send a trade".
                  
                - 'i abandoned the cop and decided to distribute'
                  //Who knows what the fuck it means. Don't try to comprehend scammer language.
                  
                - 'store[\.\-](?!steampowered|playstation|hp)[^.]+?\.com\/app\/\d+'
                  //A fairly broad filter that looks for common scam links. It's narrow enough to not have any false positives.
                  //"[^.]+" is similar to ".+", but doesn't match periods. This is necessary to avoid false positives.
                  //"\d" is a character class. Backslashes followed by letters or specific characters are basically regex commands. In this case, \d matches a single digit.
                  
                - '([Hh]i|[Hh]ello) (bro|friend), today I am leaving this (fucking)? game (with a bunch of cheaters|.+skins)'
                  //Common scammer phrase, with regex to account for minor differences.
                  
                - 'dlscord(app)?\.(codes|shop)'
                  //Discord nitro scam link.
                  
                - '(?!discord\.com)\/billing\/promotions\/[a-zA-Z0-9]{15,}\/$'
                  //Another filter for Discord nitro scams, this one more generic.
                  
                - 'wowfnatic\.site'
                  //Highly specific scam link. Unrelated to the Discord/Steam scams.
                  
                - '([Dd]iscord [Nn]itro|free|[Ss]team).+airdrop'
                  //Scammers like the word "airdrop". I don't know why. Matching common scam terms with airdrop is going to catch some scammers if the other filters don't.
                  
                - 'imgur\.com\/(a\/)?\w{6,8}(png|jpg)?.+(free|([Dd]iscord)? [Nn]itro(?! [Mm]an))[^.]+?(for [Ff]ree|([Dd]iscord)? [Nn]itro(?! [Mm]an))'
                  //Scammers like to post photoshopped imgur links as "proof" that their scam is not a scam.
                  //"\w" matches any alphanumeric character, in this case 6 to 8 times to account for a common imgur url.
                  
                - 'imgur\.com\/(a\/)?\w{6,8}(png|jpg)?.+(bit\.ly|discord\.ink)'
                  //Imgur link followed by a shortlink or a specific scam link. I should probably move the latter part elsewhere, but it works.
                  
                - '[Hh]ey cuz!!.+[Ss]team'
                  //No American or European man will casually say "Hey cuz" to a stranger. I predict some of these scammers use Slavic dialect that sounds more natural in their home country. Autoban for that on top of "steam".
                  
                - '[Dd]iscord [Nn]itro.+[Oo]ffer (ends|is valid).+(January|February|March|April|May|June|July|August|September|October|November|December) [1-3]?\d(st|nd|rd|th)?.+202[1-3]'
                  //Discord Nitro scammers will post how their "offer ends [x] time". 
                  
                - '[Gg]et [1-9] months of [Dd]iscord [Nn]itro.+Personalize your profile'
                  //If someone claims you can "get [x] months of nitro", followed by "Personalize your profile", they are a scammer.
                  //THIS FILTER DOES *NOT* SEARCH EMBEDS. POSTING LEGITIMATE DISCORD NITRO LINKS DOES NOT PUT YOU IN DANGER.
                  
                - '(skins?\.?|trade|knife|sale|Rust).+(https:\/\/i\.imgur\.com\/[a-zA-Z0-9]{6,8}\.(png|jpg))?.+https?:\/\/s(?!teamcommunity)[^.]+?\.com\/\w{3,12}(=[a-z0-9]{6,8}=\?[0-9]{1,}|\/[0-9]{15,}|\/([a-z0-9]{2,3}\/)?\?[a-z]{5,10}=[0-9]{6,14}&[a-z]{4,6}=-?\w{4,12}|\/[0-9]{5,8}\/\w{4,8}\/)$'
                  //This filter is extremely long and highly specific. Let me break it into several sections and make it easier to read.
                  
                  (skins?\.?|trade|knife|sale|Rust).+
                  //Searches for "skin", "skins", "skins,", "trade", "knife", "sale", or "Rust". An unlimited wildcard follows.
                  //As a side note: The game "Rust" is a common scam regarding scammers. Not sure why.
                  
                  (https:\/\/i\.imgur\.com\/[a-zA-Z0-9]{6,8}\.(png|jpg))?.+
                  //An optional imgur link followed by an unlimited wildcard.
                  //This is literally only here so it doesn't break the later part of the filter. It otherwise serves no purpose.
                  
                  https?:\/\/s(?!teamcommunity)[^.]+?\.com\/\w{3,12}
                  //Searches for http:// or https://.
                  //Instead of "(?!steamcommunity)", it searches "s(?!teamcommunity)" to reduce the risk of false positives.
                  //It follows up with 3 to 12 alphanumeric characters, to account for "tradeoffer" and "profile". "\w" is extremely broad here, but scammers frequently misspell "tradeoffer" and "profile" intentionally to dodge filters. The "(?!teamcommunity)" gets around them changing the domain name on the regular as well.
                  
                  (=[a-z0-9]{6,8}=\?[0-9]{1,}
                  |
                  \/[0-9]{15,}
                  |
                  \/([a-z0-9]{2,3}\/)?\?[a-z]{5,10}=[0-9]{6,14}&[a-z]{4,6}=-?\w{4,12}
                  |
                  \/[0-9]{5,8}\/\w{4,8}\/)$
                  //It searches one of four possible URL endings, since scammers frequently swap between them to, once again, evade filters. 
                  //A dollar sign indicates the string in question must be the end. So if there's any text after the URL, this regex filter won't properly match it. This is intentional; scammers ALWAYS put their URLS at the end of their message. This reduces false positives, since regular users do not always put their URLS at the end of their message.
              case_sensitive: false
              match_messages: true
              match_embeds: false
              match_visible_names: false
              match_usernames: false
              match_nicknames: false
              match_custom_status: false
          actions:
            clean: true
            log: true
            ban:
              reason: 'Scammer.'
              delete_message_days: 1
